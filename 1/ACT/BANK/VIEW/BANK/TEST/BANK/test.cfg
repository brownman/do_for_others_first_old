#!/bin/bash 
source ~/.bashrc
set -o nounset
file_present(){
    file=$1
        if [ $MODE = present ];then
            cat $file
                fi

}
set_env(){
    export MODE=present
        echo
}
breaking(){
    echo ^
        break
}
sourcing(){
    local file=$1
        if [ -f "$file" ];then
            source $file
        else
            echo 'no such file:' "$file" 
                breaking
                fi
}



loop(){
    local dir_self=`dirname $0`
        local file_list="$dir_self/list1.txt"
        local prefix=$dir_root/MODEL/BANK/BASHRC/BANK
        local desc=''
        local cmd=''
        local res=0
        local counter=1

                udpate_clipboard "vi +${counter} $file_list"
        while read  line;do
            if [ -n "$line" ];then


                desc=$(        echo "$line" | cut -d'?' -f1  )
                    cmd=$(        echo "$line" | cut -d'?' -f2  )

                    (         eval "$cmd" 1>/tmp/out 2>/tmp/err )


                    res=$?    
                    if [ $res -eq  0 ];then
                        print_color 32 "${counter}) $desc"
                            file_present /tmp/out
                    else

print_color 35 "[PENDING] $desc"
echo "[cmd] $cmd"

                        file_present /tmp/err

                udpate_clipboard "vi +${counter} $file_list"
                            fi
            else
#                echo 'empty line'
                    breaking
                    fi

                    let 'counter+=1'
                    done<$file_list
}


steps(){
    set_env
        loop
}


steps
